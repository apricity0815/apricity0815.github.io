<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://apricity0815.github.io</id>
    <title>XIUBlog</title>
    <updated>2025-11-24T12:34:09.571Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://apricity0815.github.io"/>
    <link rel="self" href="https://apricity0815.github.io/atom.xml"/>
    <subtitle>æ¸©æ•…è€ŒçŸ¥æ–°</subtitle>
    <logo>https://apricity0815.github.io/images/avatar.png</logo>
    <icon>https://apricity0815.github.io/favicon.ico</icon>
    <rights>All rights reserved 2025, XIUBlog</rights>
    <entry>
        <title type="html"><![CDATA[GoogleNet]]></title>
        <id>https://apricity0815.github.io/post/googlenet/</id>
        <link href="https://apricity0815.github.io/post/googlenet/">
        </link>
        <updated>2025-11-18T08:45:16.000Z</updated>
        <content type="html"><![CDATA[<h1 id="1ç½‘ç»œ-äº®ç‚¹">1.ç½‘ç»œ äº®ç‚¹ï¼š</h1>
<ol>
<li>å¼•å…¥Inceptionç»“æ„ï¼ˆèåˆä¸åŒå°ºåº¦çš„ç‰¹å¾ä¿¡æ¯ï¼‰</li>
<li>ä½¿ç”¨1âœ–1çš„å·ç§¯æ ¸è¿›è¡Œé™ç»´ä»¥åŠæ˜ å°„å¤„ç†</li>
<li>æ·»åŠ ä¸¤ä¸ªè¾…åŠ©åˆ†ç±»å™¨å¸®åŠ©è®­ç»ƒ</li>
<li>ä¸¢å¼ƒå…¨è¿æ¥å±‚ï¼Œä½¿ç”¨å¹³å‡æ± åŒ–å±‚ï¼ˆå‡å°‘äº†æ¨¡å‹å‚æ•°ï¼‰<br>
<img src="https://apricity0815.github.io/post-images/1763985711572.png" alt="" loading="lazy"></li>
</ol>
<h1 id="2googlenet-ç½‘ç»œç»“æ„è§£æ">2.GoogLeNet ç½‘ç»œç»“æ„è§£æ</h1>
<h2 id="21-åˆå§‹å±‚">2.1 åˆå§‹å±‚</h2>
<figure data-type="image" tabindex="1"><img src="https://apricity0815.github.io/post-images/1763985838502.png" alt="" loading="lazy"></figure>
<ul>
<li>å·ç§¯å±‚ï¼šGoogLeNet å¼€å§‹äºä¸€ä¸ª 7x7 çš„å·ç§¯å±‚ï¼Œé€šå¸¸å¸¦æœ‰æ­¥å¹…ä¸º 2ï¼Œç”¨äºåˆæ­¥æå–å›¾åƒä¸­çš„åŸºæœ¬ç‰¹å¾ã€‚</li>
<li>æœ€å¤§æ± åŒ–å±‚ï¼šç´§éšå…¶åçš„æ˜¯ä¸€ä¸ª 3x3 çš„æœ€å¤§æ± åŒ–å±‚ï¼Œæ­¥å¹…ä¸º 2ï¼Œç”¨äºå‡å°ç‰¹å¾å›¾çš„å°ºå¯¸ï¼Œé™ä½è®¡ç®—é‡ã€‚</li>
<li>å·ç§¯å±‚ï¼šä¹‹åæ˜¯ä¸¤ä¸ªè¿ç»­çš„ 3x3 å·ç§¯å±‚ï¼Œç”¨äºè¿›ä¸€æ­¥ç‰¹å¾æå–ã€‚</li>
<li>æœ€å¤§æ± åŒ–å±‚ï¼šå†æ¬¡è¿›è¡Œæœ€å¤§æ± åŒ–ï¼Œç»§ç»­å‡å°ç‰¹å¾å›¾çš„å°ºå¯¸ã€‚</li>
</ul>
<h2 id="22-inceptionç»“æ„">2.2 Inceptionç»“æ„</h2>
<h3 id="221-inceptionåŸå§‹ç»“æ„ä¸€ç§å¹¶è”ç»“æ„å°†ç‰¹å¾çŸ©é˜µåŒæ—¶è¾“å…¥åˆ°å¤šä¸ªåˆ†æ”¯è¿›è¡Œå¤„ç†å¹¶å°†è¾“å‡ºçš„ç‰¹å¾çŸ©é˜µæŒ‰æ·±åº¦è¿›è¡Œæ‹¼æ¥å¾—åˆ°æœ€ç»ˆè¾“å‡º">2.2.1 <strong>InceptionåŸå§‹ç»“æ„</strong>ï¼šä¸€ç§å¹¶è”ç»“æ„ï¼Œå°†ç‰¹å¾çŸ©é˜µåŒæ—¶è¾“å…¥åˆ°å¤šä¸ªåˆ†æ”¯è¿›è¡Œå¤„ç†ï¼Œå¹¶å°†è¾“å‡ºçš„ç‰¹å¾çŸ©é˜µæŒ‰æ·±åº¦è¿›è¡Œæ‹¼æ¥ï¼Œå¾—åˆ°æœ€ç»ˆè¾“å‡ºã€‚</h3>
<p><strong>ä½œç”¨</strong>ï¼šå¢åŠ ç½‘ç»œæ·±åº¦å’Œå®½åº¦çš„åŒæ—¶å‡å°‘å‚æ•°<br>
<img src="https://apricity0815.github.io/post-images/1763985825545.png" alt="" loading="lazy"></p>
<h3 id="222-inception-é™ç»´åœ¨åŸå§‹-inception-ç»“æ„çš„åŸºç¡€ä¸Šåœ¨åˆ†æ”¯-234-ä¸ŠåŠ å…¥äº†å·ç§¯æ ¸å¤§å°ä¸º-1x1-çš„å·ç§¯å±‚ç›®çš„æ˜¯ä¸ºäº†é™ç»´å‡å°æ·±åº¦å‡å°‘æ¨¡å‹è®­ç»ƒå‚æ•°å‡å°‘è®¡ç®—é‡">2.2.2 <strong>inception + é™ç»´</strong>ï¼šåœ¨åŸå§‹ inception ç»“æ„çš„åŸºç¡€ä¸Šï¼Œåœ¨åˆ†æ”¯ 2ï¼Œ3ï¼Œ4 ä¸ŠåŠ å…¥äº†å·ç§¯æ ¸å¤§å°ä¸º 1x1 çš„å·ç§¯å±‚ï¼Œç›®çš„æ˜¯ä¸ºäº†é™ç»´ï¼ˆå‡å°æ·±åº¦ï¼‰ï¼Œå‡å°‘æ¨¡å‹è®­ç»ƒå‚æ•°ï¼Œå‡å°‘è®¡ç®—é‡ã€‚</h3>
<figure data-type="image" tabindex="2"><img src="https://apricity0815.github.io/post-images/1763985872534.png" alt="" loading="lazy"></figure>
<ul>
<li><strong>1x1 å·ç§¯åˆ†æ”¯</strong>ï¼šç”¨äºé™ç»´ï¼Œå‡å°‘åç»­è®¡ç®—çš„æˆæœ¬ã€‚</li>
<li><strong>3x3 å·ç§¯åˆ†æ”¯</strong>ï¼šç”¨äºæå–å±€éƒ¨ç‰¹å¾ï¼Œé€šå¸¸åœ¨ 1x1 å·ç§¯ä¹‹åã€‚</li>
<li><strong>5x5 å·ç§¯åˆ†æ”¯</strong>ï¼šç”¨äºæ•è·æ›´å¤§èŒƒå›´çš„ç‰¹å¾ï¼ŒåŒæ ·åœ¨ 1x1 å·ç§¯ä¹‹åã€‚</li>
<li><strong>æœ€å¤§æ± åŒ–åˆ†æ”¯</strong>ï¼šç”¨äºæ•æ‰å›¾åƒä¸­çš„é‡è¦ç‰¹å¾ï¼ŒåŒæ—¶åœ¨æ± åŒ–ä¹‹åä½¿ç”¨ 1x1 å·ç§¯ä»¥ä¿æŒé€šé“æ•°ã€‚<br>
<em>æ³¨ï¼šCNN å‚æ•°ä¸ªæ•° = å·ç§¯æ ¸å°ºå¯¸Ã—å·ç§¯æ ¸æ·±åº¦ Ã— å·ç§¯æ ¸ç»„æ•° = å·ç§¯æ ¸å°ºå¯¸ Ã— è¾“å…¥ç‰¹å¾çŸ©é˜µæ·±åº¦ Ã— è¾“å‡ºç‰¹å¾çŸ©é˜µæ·±åº¦</em></li>
</ul>
<h3 id="223ç»†èŠ‚è¯¦è§£">2.2.3ç»†èŠ‚è¯¦è§£ï¼š</h3>
<h4 id="11å·ç§¯æ ¸é™ç»´åŠŸèƒ½ä¸¾ä¾‹"><strong>1Ã—1å·ç§¯æ ¸é™ç»´åŠŸèƒ½ä¸¾ä¾‹</strong>ï¼š</h4>
<figure data-type="image" tabindex="3"><img src="https://apricity0815.github.io/post-images/1763985887135.png" alt="" loading="lazy"></figure>
<h4 id="inceptionæ¨¡å—åªä¼šæ”¹å˜ç‰¹å¾å›¾çš„é€šé“æ•°è€Œä¸ä¼šæ”¹å˜ç‰¹å¾å›¾å°ºå¯¸å¤§å°"><strong>Inceptionæ¨¡å—åªä¼šæ”¹å˜ç‰¹å¾å›¾çš„é€šé“æ•°ï¼Œè€Œä¸ä¼šæ”¹å˜ç‰¹å¾å›¾å°ºå¯¸å¤§å°</strong>ï¼š</h4>
<ul>
<li>Inceptionæ¨¡å—çš„æ ¸å¿ƒæ€æƒ³æ˜¯åœ¨<strong>åŒä¸€ç½‘ç»œå±‚</strong>ä¸­æå–<strong>ä¸åŒå°ºåº¦</strong>çš„ç‰¹å¾ï¼Œç„¶åå°†å®ƒä»¬èåˆã€‚å¦‚æœç‰¹å¾å›¾å°ºå¯¸æ”¹å˜ï¼Œä¸åŒåˆ†æ”¯çš„è¾“å‡ºå°±æ— æ³•ç›´æ¥æ‹¼æ¥ã€‚</li>
<li>ä¸ºäº†ä¿æŒç‰¹å¾å›¾å°ºå¯¸ä¸å˜ï¼ŒInceptionæ¨¡å—ä¸­çš„æ¯ä¸ªå·ç§¯æ“ä½œéƒ½ä½¿ç”¨äº†<strong>ç²¾ç¡®çš„paddingç­–ç•¥</strong></li>
<li>å·ç§¯æ ¸å¤§å°ä¸ºKï¼Œæ­¥é•¿ä¸ºSï¼Œè¾“å…¥å°ºå¯¸ä¸ºWï¼Œè¾“å‡ºå°ºå¯¸ä¸ºW'ï¼Œå¡«å……ä¸ºPï¼š<strong>W' = (W - K + 2P) / S + 1</strong></li>
</ul>
<pre><code># ç¤ºä¾‹ï¼šInceptionæ¨¡å—ä¸­çš„å·ç§¯æ“ä½œ
1Ã—1 å·ç§¯: padding=0  # ä¿æŒå°ºå¯¸ä¸å˜
3Ã—3 å·ç§¯: padding=1  # ä¿æŒå°ºå¯¸ä¸å˜  
5Ã—5 å·ç§¯: padding=2  # ä¿æŒå°ºå¯¸ä¸å˜
æ± åŒ–å±‚:   padding=1  # ä¿æŒå°ºå¯¸ä¸å˜
</code></pre>
<h4 id="æ¨¡å—ä¸­ä¸å¯¹ç§°è®¾è®¡"><strong>æ¨¡å—ä¸­ä¸å¯¹ç§°è®¾è®¡</strong></h4>
<h5 id="å·ç§¯åˆ†æ”¯å…ˆ11å·ç§¯æ˜¯ä¸ºäº†è®¡ç®—æ•ˆç‡é¿å…å¤§å·ç§¯æ ¸åœ¨é«˜é€šé“æ•°ä¸‹çš„è®¡ç®—çˆ†ç‚¸"><strong>å·ç§¯åˆ†æ”¯</strong>ï¼šå…ˆ1Ã—1å·ç§¯æ˜¯ä¸ºäº†<strong>è®¡ç®—æ•ˆç‡</strong>ï¼Œé¿å…å¤§å·ç§¯æ ¸åœ¨é«˜é€šé“æ•°ä¸‹çš„è®¡ç®—çˆ†ç‚¸</h5>
<p>å¤§å°ºå¯¸å·ç§¯æ ¸ï¼ˆ3Ã—3, 5Ã—5ï¼‰åœ¨<strong>é«˜é€šé“æ•°</strong>æ—¶è®¡ç®—æˆæœ¬æé«˜</p>
<pre><code># è®¡ç®—é‡å¯¹æ¯”
è¾“å…¥: 28Ã—28Ã—256

# ç›´æ¥5Ã—5å·ç§¯
5Ã—5å·ç§¯, è¾“å‡º128é€šé“: è®¡ç®—é‡ = 28Ã—28Ã—256Ã—5Ã—5Ã—128 â‰ˆ 6.4äº¿æ¬¡è¿ç®—

# å…ˆ1Ã—1é™ç»´å†5Ã—5å·ç§¯  
1Ã—1å·ç§¯é™åˆ°64é€šé“: 28Ã—28Ã—256Ã—1Ã—1Ã—64 â‰ˆ 1.3äº¿æ¬¡è¿ç®—
5Ã—5å·ç§¯, è¾“å‡º128é€šé“: 28Ã—28Ã—64Ã—5Ã—5Ã—128 â‰ˆ 1.6äº¿æ¬¡è¿ç®—
æ€»è®¡ç®—é‡ â‰ˆ 2.9äº¿æ¬¡è¿ç®— (å‡å°‘55%ï¼)
</code></pre>
<p>é™ç»´æ•ˆæœï¼š</p>
<pre><code># 3Ã—3å·ç§¯åˆ†æ”¯
branch_3x3 = Conv1x1(input, filters=96)    # å…ˆé™ç»´
branch_3x3 = Conv3x3(branch_3x3, filters=128)  # å†æå–ç‰¹å¾

# 5Ã—5å·ç§¯åˆ†æ”¯  
branch_5x5 = Conv1x1(input, filters=16)    # å…ˆå¤§å¹…é™ç»´
branch_5x5 = Conv5x5(branch_5x5, filters=32)   # å†æå–ç‰¹å¾
</code></pre>
<h5 id="æ± åŒ–åˆ†æ”¯å…ˆmaxpoolæ˜¯ä¸ºäº†ç‰¹å¾å®Œæ•´æ€§ç¡®ä¿ç©ºé—´ä¸‹é‡‡æ ·åŸºäºæœ€æ˜¾è‘—-æœ€åŸå§‹çš„ç‰¹å¾å“åº”"><strong>æ± åŒ–åˆ†æ”¯</strong>ï¼šå…ˆMaxPoolæ˜¯ä¸ºäº†<strong>ç‰¹å¾å®Œæ•´æ€§</strong>ï¼Œç¡®ä¿ç©ºé—´ä¸‹é‡‡æ ·åŸºäºæœ€æ˜¾è‘—ã€æœ€åŸå§‹çš„ç‰¹å¾å“åº”</h5>
<pre><code># å¦‚æœæ± åŒ–åˆ†æ”¯ä¹Ÿå…ˆ1Ã—1å·ç§¯ä¼šæ€æ ·ï¼Ÿ
ä¸å¥½çš„è®¾è®¡: Conv1x1 â†’ MaxPool
é—®é¢˜: 1Ã—1å·ç§¯ä¼šæ”¹å˜æ‰€æœ‰åƒç´ å€¼ï¼Œå¯èƒ½ç ´ååŸå§‹çš„ç©ºé—´ç‰¹å¾ç»“æ„

# å®é™…è®¾è®¡: å…ˆMaxPoolå†1Ã—1å·ç§¯
å¥½çš„è®¾è®¡: MaxPool â†’ Conv1x1
ä¼˜åŠ¿: å…ˆä¿ç•™æœ€æ˜¾è‘—çš„ç©ºé—´ç‰¹å¾ï¼Œå†è°ƒæ•´é€šé“æ•°


å‡è®¾è¾“å…¥ç‰¹å¾å›¾æŸä¸ªå±€éƒ¨åŒºåŸŸï¼š
è¾“å…¥åŒºåŸŸ = [[10, 8, 5],
           [9, 12, 7], 
           [6, 4, 3]]  # æœ€å¤§å€¼12åœ¨ä¸­å¿ƒ

# æ–¹æ¡ˆA: å…ˆ1Ã—1å·ç§¯ï¼ˆå‡è®¾æƒé‡ä¸º0.5ï¼‰
å¤„ç†å = [[5, 4, 2.5],
         [4.5, 6, 3.5],
         [3, 2, 1.5]]
MaxPoolå = 6  # ä¸¢å¤±äº†åŸå§‹çš„æœ€å¤§å“åº”12ï¼

# æ–¹æ¡ˆB: å…ˆMaxPool  
MaxPoolå = 12  # ä¿ç•™åŸå§‹æœ€å¤§å“åº”
1Ã—1å·ç§¯å = 12 Ã— 0.5 = 6  # åªæ˜¯ç¼©æ”¾ï¼Œä¿¡æ¯æœ¬è´¨ä¸å˜
</code></pre>
<h2 id="23-è¾…åŠ©åˆ†ç±»æ¨¡å—">2.3 è¾…åŠ©åˆ†ç±»æ¨¡å—</h2>
<ul>
<li>GoogLeNet æœ‰ 3 ä¸ªè¾“å‡ºå±‚ï¼Œå…¶ä¸­çš„ä¸¤ä¸ªæ˜¯è¾…åŠ©åˆ†ç±»å±‚ã€‚</li>
<li>ä¸¤ä¸ªè¾…åŠ©è¾“å‡ºå±‚ç»“æ„ç›¸åŒï¼Œä½†ä½äºç½‘ç»œçš„ä¸åŒæ·±åº¦ã€‚
<ul>
<li><strong>è¾…åŠ©è¾“å‡ºå±‚1</strong>ï¼šä½äºç½‘ç»œä¸­é—´å±‚ï¼ˆåœ¨Inception 4aä¹‹åï¼‰</li>
<li><strong>è¾…åŠ©è¾“å‡ºå±‚2</strong>ï¼šä½äºç½‘ç»œä¸­åå±‚ï¼ˆåœ¨Inception 4dä¹‹åï¼‰</li>
</ul>
</li>
<li>è¾…åŠ©åˆ†ç±»å™¨ï¼š
<ul>
<li>å¹³å‡æ± åŒ–å±‚ï¼š</li>
<li>1Ã—1å·ç§¯å±‚</li>
<li>å…¨è¿æ¥å±‚</li>
<li>å…¨è¿æ¥å±‚</li>
<li>Softmaxï¼šç”¨äºå¤šåˆ†ç±»ç¥ç»ç½‘ç»œè¾“å‡º
<ul>
<li>\sigma(\mathbf{z})_i = \frac{e<sup>{z_i}}{\sum_{j=1}</sup>{N} e^{z_j}}</li>
<li>ç”¨äºå¤šäºä¸€ä¸ªè¾“å‡ºçš„ç¥ç»å…ƒï¼Œä¿è¯æ‰€æœ‰çš„è¾“å‡ºç¥ç»å…ƒä¹‹å’Œä¸º1.0ï¼Œæ‰€ä»¥ä¸€èˆ¬è¾“å‡ºçš„æ˜¯å°äº1çš„æ¦‚ç‡å€¼ï¼Œå¯ä»¥å¾ˆç›´è§‚åœ°æ¯”è¾ƒå„è¾“å‡ºå€¼ã€‚<br>
<img src="https://apricity0815.github.io/post-images/1763985975743.png" alt="" loading="lazy"><br>
<img src="https://apricity0815.github.io/post-images/1763985983127.png" alt="" loading="lazy"><br>
<strong>ä½œç”¨ï¼š</strong></li>
</ul>
</li>
</ul>
</li>
<li>é¿å…æ¢¯åº¦æ¶ˆå¤±ï¼Œç”¨äºå‘å‰ä¼ å¯¼æ¢¯åº¦ã€‚åå‘ä¼ æ’­æ—¶å¦‚æœæœ‰ä¸€å±‚æ±‚å¯¼ä¸ºï¼ˆæ— é™é€¼è¿‘ï¼‰0ï¼Œé“¾å¼æ±‚å¯¼ç»“æœåˆ™ä¸º0ã€‚</li>
<li>å°†ä¸­é—´æŸä¸€å±‚è¾“å‡ºç”¨ä½œåˆ†ç±»ï¼Œå¹¶æŒ‰ä¸€ä¸ªè¾ƒå°çš„æƒé‡(0.3)åŠ åˆ°æœ€ç»ˆåˆ†ç±»ç»“æœï¼Œèµ·åˆ°æ¨¡å‹èåˆä½œç”¨ã€‚</li>
</ul>
<h2 id="24-è¾“å‡ºå±‚">2.4 è¾“å‡ºå±‚</h2>
<p><img src="https://apricity0815.github.io/post-images/1763986332325.png" alt="" loading="lazy"><br>
<strong>ç‰¹ç‚¹ï¼š</strong> ä½¿ç”¨<strong>å…¨å±€å¹³å‡æ± åŒ–å±‚</strong> å’Œ<strong>ä¸€å±‚å…¨è¿æ¥å±‚</strong> ä»£æ›¿åŸæ¥çš„ä¸¤å±‚å…¨è¿æ¥å±‚ï¼ˆAlexNetï¼‰<br>
<strong>ä½œç”¨ï¼š</strong></p>
<ul>
<li><strong>å‡å°‘å‚æ•°æ•°é‡ï¼Œé˜²æ­¢è¿‡æ‹Ÿåˆï¼š</strong> å…¨è¿æ¥å±‚ä¼šå¼•å…¥å¤§é‡å‚æ•°ï¼Œæ˜“å¯¼è‡´è¿‡æ‹Ÿåˆã€‚è€Œå…¨å±€å¹³å‡æ± åŒ–å±‚æ²¡æœ‰å‚æ•°ï¼Œå®ƒåªæ˜¯å¯¹æ¯ä¸ªç‰¹å¾å›¾å–å¹³å‡å€¼ã€‚ç„¶åæ¥ä¸€ä¸ªå…¨è¿æ¥å±‚ï¼Œå…¶å‚æ•°æ•°é‡ä¸ºï¼ˆé€šé“æ•°Ã—ç±»åˆ«æ•°ï¼‰ã€‚ä¾‹å¦‚ï¼Œå¦‚æœé€šé“æ•°æ˜¯1024ï¼Œç±»åˆ«æ•°æ˜¯1000ï¼Œé‚£ä¹ˆå‚æ•°ä¸º1024*1000=1.024Mï¼Œå¤§å¤§å‡å°‘äº†å‚æ•°æ•°é‡ã€‚</li>
<li><strong>å…¨å±€å¹³å‡æ± åŒ–å±‚ä½œä¸ºæ­£åˆ™åŒ–å™¨</strong>ï¼šé€šè¿‡å¯¹æ¯ä¸ªç‰¹å¾å›¾å–å¹³å‡å€¼ï¼Œå¼ºåˆ¶ä½¿ç‰¹å¾å›¾ä¸ç±»åˆ«ä¹‹é—´äº§ç”Ÿå…³è”ï¼Œæœ‰åŠ©äºæé«˜æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ã€‚æ¯ä¸ªç‰¹å¾å›¾å¯ä»¥è¢«è§†ä¸ºå¯¹æŸä¸ªç±»åˆ«ç‰¹å¾çš„å“åº”ï¼Œå…¨å±€å¹³å‡æ± åŒ–åˆ™ç»¼åˆè¿™äº›å“åº”ã€‚</li>
</ul>
<h1 id="3å¤ç°">3.å¤ç°</h1>
<pre><code>import torch
from torch import nn
from torch.nn import functional as F
from torchinfo import summary

class GoogLeNet(nn.Module):
    def __init__(self, num_classes=1000, aux_logits=True, init_weights=False):
        super(GoogLeNet, self).__init__()
        self.aux_logits = aux_logits

        self.conv1 = BasicConv2d(3, 64, kernel_size=7, stride=2, padding=3)
        self.maxpool1 = nn.MaxPool2d(3, stride=2, ceil_mode=True)

        self.conv2 = BasicConv2d(64, 64, kernel_size=1)
        self.conv3 = BasicConv2d(64, 192, kernel_size=3, padding=1)
        self.maxpool2 = nn.MaxPool2d(3, stride=2, ceil_mode=True)

        self.inception3a = Inception(192, 64, 96, 128, 16, 32, 32)
        self.inception3b = Inception(256, 128, 128, 192, 32, 96, 64)
        self.maxpool3 = nn.MaxPool2d(3, stride=2, ceil_mode=True)

        self.inception4a = Inception(480, 192, 96, 208, 16, 48, 64)
        self.inception4b = Inception(512, 160, 112, 224, 24, 64, 64)
        self.inception4c = Inception(512, 128, 128, 256, 24, 64, 64)
        self.inception4d = Inception(512, 112, 144, 288, 32, 64, 64)
        self.inception4e = Inception(528, 256, 160, 320, 32, 128, 128)
        self.maxpool4 = nn.MaxPool2d(3, stride=2, ceil_mode=True)

        self.inception5a = Inception(832, 256, 160, 320, 32, 128, 128)
        self.inception5b = Inception(832, 384, 192, 384, 48, 128, 128)

        if self.aux_logits:
            self.aux1 = InceptionAux(512, num_classes)
            self.aux2 = InceptionAux(528, num_classes)

        self.avgpool = nn.AdaptiveAvgPool2d((1, 1))
        self.dropout = nn.Dropout(0.4)
        self.fc = nn.Linear(1024, num_classes)
        if init_weights:
            self._initialize_weights()

    def forward(self, x):
        # N x 3 x 224 x 224
        x = self.conv1(x)
        # N x 64 x 112 x 112
        x = self.maxpool1(x)
        # N x 64 x 56 x 56
        x = self.conv2(x)
        # N x 64 x 56 x 56
        x = self.conv3(x)
        # N x 192 x 56 x 56
        x = self.maxpool2(x)

        # N x 192 x 28 x 28
        x = self.inception3a(x)
        # N x 256 x 28 x 28
        x = self.inception3b(x)
        # N x 480 x 28 x 28
        x = self.maxpool3(x)
        # N x 480 x 14 x 14
        x = self.inception4a(x)
        # N x 512 x 14 x 14
        if self.training and self.aux_logits:    # eval model lose this layer
            aux1 = self.aux1(x)

        x = self.inception4b(x)
        # N x 512 x 14 x 14
        x = self.inception4c(x)
        # N x 512 x 14 x 14
        x = self.inception4d(x)
        # N x 528 x 14 x 14
        if self.training and self.aux_logits:    # eval model lose this layer
            aux2 = self.aux2(x)

        x = self.inception4e(x)
        # N x 832 x 14 x 14
        x = self.maxpool4(x)
        # N x 832 x 7 x 7
        x = self.inception5a(x)
        # N x 832 x 7 x 7
        x = self.inception5b(x)
        # N x 1024 x 7 x 7

        x = self.avgpool(x)
        # N x 1024 x 1 x 1
        x = torch.flatten(x, 1)
        # N x 1024
        x = self.dropout(x)
        x = self.fc(x)
        # N x 1000 (num_classes)
        if self.training and self.aux_logits:   # eval model lose this layer
            return x, aux2, aux1
        return x

    def _initialize_weights(self):
        for m in self.modules():
            if isinstance(m, nn.Conv2d):
                nn.init.kaiming_normal_(m.weight, mode='fan_out', nonlinearity='relu')
                if m.bias is not None:
                    nn.init.constant_(m.bias, 0)
            elif isinstance(m, nn.Linear):
                nn.init.normal_(m.weight, 0, 0.01)
                nn.init.constant_(m.bias, 0)

#inceptionç»“æ„
class Inception(nn.Module):
    def __init__(self, in_channels, ch1x1, ch3x3red, ch3x3, ch5x5red, ch5x5, pool_proj):
        super(Inception, self).__init__()

        self.branch1 = BasicConv2d(in_channels, ch1x1, kernel_size=1)

        self.branch2 = nn.Sequential(
            BasicConv2d(in_channels, ch3x3red, kernel_size=1),
            BasicConv2d(ch3x3red, ch3x3, kernel_size=3, padding=1)   # ä¿è¯è¾“å‡ºå¤§å°ç­‰äºè¾“å…¥å¤§å°
        )

        self.branch3 = nn.Sequential(
            BasicConv2d(in_channels, ch5x5red, kernel_size=1),
            BasicConv2d(ch5x5red, ch5x5, kernel_size=5, padding=2)   # ä¿è¯è¾“å‡ºå¤§å°ç­‰äºè¾“å…¥å¤§å°
        )

        self.branch4 = nn.Sequential(
            nn.MaxPool2d(kernel_size=3, stride=1, padding=1),
            BasicConv2d(in_channels, pool_proj, kernel_size=1)
        )

    def forward(self, x):
        branch1 = self.branch1(x)
        branch2 = self.branch2(x)
        branch3 = self.branch3(x)
        branch4 = self.branch4(x)

        outputs = [branch1, branch2, branch3, branch4]
        return torch.cat(outputs, 1)

#è¾…åŠ©åˆ†ç±»å™¨
class InceptionAux(nn.Module):
    def __init__(self, in_channels, num_classes):
        super(InceptionAux, self).__init__()
        self.averagePool = nn.AvgPool2d(kernel_size=5, stride=3)
        self.conv = BasicConv2d(in_channels, 128, kernel_size=1)  # output[batch, 128, 4, 4]

        self.fc1 = nn.Linear(2048, 1024)
        self.fc2 = nn.Linear(1024, num_classes)

    def forward(self, x):
        # aux1: N x 512 x 14 x 14, aux2: N x 528 x 14 x 14
        x = self.averagePool(x)
        # aux1: N x 512 x 4 x 4, aux2: N x 528 x 4 x 4
        x = self.conv(x)
        # N x 128 x 4 x 4
        x = torch.flatten(x, 1)
        x = F.dropout(x, 0.5, training=self.training)
        # N x 2048
        x = F.relu(self.fc1(x), inplace=True)
        x = F.dropout(x, 0.5, training=self.training)
        # N x 1024
        x = self.fc2(x)
        # N x num_classes
        return x


class BasicConv2d(nn.Module):
    def __init__(self, in_channels, out_channels, **kwargs):
        super(BasicConv2d, self).__init__()
        self.conv = nn.Conv2d(in_channels, out_channels, **kwargs)
        self.relu = nn.ReLU(inplace=True)

    def forward(self, x):
        x = self.conv(x)
        x = self.relu(x)
        return x

data = torch.ones(20,3,223,224)
net = GoogLeNet()
summary(net,(20,3,224,224),device=&quot;cpu&quot;)
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Hello Gridea]]></title>
        <id>https://apricity0815.github.io/post/hello-gridea/</id>
        <link href="https://apricity0815.github.io/post/hello-gridea/">
        </link>
        <updated>2018-12-11T16:00:00.000Z</updated>
        <summary type="html"><![CDATA[<p>ğŸ‘  æ¬¢è¿ä½¿ç”¨ <strong>Gridea</strong> ï¼<br>
âœï¸  <strong>Gridea</strong> ä¸€ä¸ªé™æ€åšå®¢å†™ä½œå®¢æˆ·ç«¯ã€‚ä½ å¯ä»¥ç”¨å®ƒæ¥è®°å½•ä½ çš„ç”Ÿæ´»ã€å¿ƒæƒ…ã€çŸ¥è¯†ã€ç¬”è®°ã€åˆ›æ„... ...</p>
]]></summary>
        <content type="html"><![CDATA[<p>ğŸ‘  æ¬¢è¿ä½¿ç”¨ <strong>Gridea</strong> ï¼<br>
âœï¸  <strong>Gridea</strong> ä¸€ä¸ªé™æ€åšå®¢å†™ä½œå®¢æˆ·ç«¯ã€‚ä½ å¯ä»¥ç”¨å®ƒæ¥è®°å½•ä½ çš„ç”Ÿæ´»ã€å¿ƒæƒ…ã€çŸ¥è¯†ã€ç¬”è®°ã€åˆ›æ„... ...</p>
<!-- more -->
<p><a href="https://github.com/getgridea/gridea">Github</a><br>
<a href="https://gridea.dev/">Gridea ä¸»é¡µ</a><br>
<a href="https://fehey.com/">ç¤ºä¾‹ç½‘ç«™</a></p>
<h2 id="ç‰¹æ€§">ç‰¹æ€§ğŸ‘‡</h2>
<p>ğŸ“  ä½ å¯ä»¥ä½¿ç”¨æœ€é…·çš„ <strong>Markdown</strong> è¯­æ³•ï¼Œè¿›è¡Œå¿«é€Ÿåˆ›ä½œ</p>
<p>ğŸŒ‰  ä½ å¯ä»¥ç»™æ–‡ç« é…ä¸Šç²¾ç¾çš„å°é¢å›¾å’Œåœ¨æ–‡ç« ä»»æ„ä½ç½®æ’å…¥å›¾ç‰‡</p>
<p>ğŸ·ï¸  ä½ å¯ä»¥å¯¹æ–‡ç« è¿›è¡Œæ ‡ç­¾åˆ†ç»„</p>
<p>ğŸ“‹  ä½ å¯ä»¥è‡ªå®šä¹‰èœå•ï¼Œç”šè‡³å¯ä»¥åˆ›å»ºå¤–éƒ¨é“¾æ¥èœå•</p>
<p>ğŸ’»  ä½ å¯ä»¥åœ¨ <strong>Windows</strong>ï¼Œ<strong>MacOS</strong> æˆ– <strong>Linux</strong> è®¾å¤‡ä¸Šä½¿ç”¨æ­¤å®¢æˆ·ç«¯</p>
<p>ğŸŒ  ä½ å¯ä»¥ä½¿ç”¨ <strong>ğ–¦ğ—‚ğ—ğ—ğ—ğ–» ğ–¯ğ–ºğ—€ğ–¾ğ—Œ</strong> æˆ– <strong>Coding Pages</strong> å‘ä¸–ç•Œå±•ç¤ºï¼Œæœªæ¥å°†æ”¯æŒæ›´å¤šå¹³å°</p>
<p>ğŸ’¬  ä½ å¯ä»¥è¿›è¡Œç®€å•çš„é…ç½®ï¼Œæ¥å…¥ <a href="https://github.com/gitalk/gitalk">Gitalk</a> æˆ– <a href="https://github.com/SukkaW/DisqusJS">DisqusJS</a> è¯„è®ºç³»ç»Ÿ</p>
<p>ğŸ‡¬ğŸ‡§  ä½ å¯ä»¥ä½¿ç”¨<strong>ä¸­æ–‡ç®€ä½“</strong>æˆ–<strong>è‹±è¯­</strong></p>
<p>ğŸŒ  ä½ å¯ä»¥ä»»æ„ä½¿ç”¨åº”ç”¨å†…é»˜è®¤ä¸»é¢˜æˆ–ä»»æ„ç¬¬ä¸‰æ–¹ä¸»é¢˜ï¼Œå¼ºå¤§çš„ä¸»é¢˜è‡ªå®šä¹‰èƒ½åŠ›</p>
<p>ğŸ–¥  ä½ å¯ä»¥è‡ªå®šä¹‰æºæ–‡ä»¶å¤¹ï¼Œåˆ©ç”¨ OneDriveã€ç™¾åº¦ç½‘ç›˜ã€iCloudã€Dropbox ç­‰è¿›è¡Œå¤šè®¾å¤‡åŒæ­¥</p>
<p>ğŸŒ± å½“ç„¶ <strong>Gridea</strong> è¿˜å¾ˆå¹´è½»ï¼Œæœ‰å¾ˆå¤šä¸è¶³ï¼Œä½†è¯·ç›¸ä¿¡ï¼Œå®ƒä¼šä¸åœå‘å‰ ğŸƒ</p>
<p>æœªæ¥ï¼Œå®ƒä¸€å®šä¼šæˆä¸ºä½ ç¦»ä¸å¼€çš„ä¼™ä¼´</p>
<p>å°½æƒ…å‘æŒ¥ä½ çš„æ‰åå§ï¼</p>
<p>ğŸ˜˜ Enjoy~</p>
]]></content>
    </entry>
</feed>